import{r as u,s as r,q as l,p as S,a as n,m as T,j as c,S as P,L as i,w as L,J as v,ay as w,ag as D,I,d as b,ar as k,R as x,C as f,n as F}from"./index-a5f9a2c2.js";const _=[{id:"123",title:"Shopping List",content:"Milk, eggs, bread, butter",timestamp:Date.now()-1e3*60*60*2},{id:"1414",title:"To Do List",content:`- Finish the UI
- Implement the backend
- Deploy the app`,timestamp:Date.now()-1e3*60*60*5},{id:"51515",title:"another list",content:`this is yet another list, it functions as a test for the notes app.

You can add new notes, edit them, and delete them.`,timestamp:Date.now()-1e3*60*60*24*2}];function M(){const[N,O]=u.useState(""),[a,h]=u.useState([]),[o,d]=u.useState(null);u.useEffect(()=>{if(r.APPS.NOTES.notes.value&&r.APPS.NOTES.notes.value.length>0){l("info","Using cached notes, not fetching",r.APPS.NOTES.notes.value),h(r.APPS.NOTES.notes.value);return}l("info","Fetching notes"),S("Notes",{action:"fetch"},_).then(e=>{if(!e)return l("warning","Failed to fetch notes, server returned false");l("info","Fetched notes",e),h(e),r.APPS.NOTES.notes.set(e)})},[]);const A=e=>{let s=Math.floor(Date.now()),t={title:i("APPS.NOTES.NEW_NOTE"),content:"",timestamp:s,id:null};S("Notes",{action:"create",data:t},(Math.random()*1e6).toString()).then(m=>{t.id=m,d(t),h([...a,t]),r.APPS.NOTES.notes.set([...a,t])})},g=e=>{let s=Math.floor(Date.now()),t=[...a],m=t.findIndex(E=>E.id===e.id),p=t[m];if(p.title===e.title&&p.content===e.content){l("info","Note is the same, not saving"),d(null);return}t[m]={...e,timestamp:s},S("Notes",{action:"save",data:t[m]},!0).then(E=>{if(!E)return l("warning","Failed to save note, server returned false");l("info","Saved note"),d(null),h(t),r.APPS.NOTES.notes.set(t)})},C=e=>{S("Notes",{action:"remove",id:e},!0).then(s=>{if(!s)return l("warning","Failed to remove note, server returned false");let t=a==null?void 0:a.filter(m=>m.id!==e);d(null),h(t),r.APPS.NOTES.notes.set(t),l("info","Removed note")})};return n(T.div,{className:"notes-container",children:o?c(T.div,{...P("right","note",.2),className:"notes-wrapper note",children:[c("div",{className:"top",children:[c("div",{className:"back",onClick:()=>g(o),children:[n(I,{}),i("APPS.NOTES.TITLE")]}),n(b,{className:"title",defaultValue:o.title,onChange:e=>d({...o,title:e.target.value})}),n("div",{})]}),n(k,{onChange:e=>d({...o,content:e.target.value}),defaultValue:o.content}),c("div",{className:"notes-bottom",children:[n(x,{onClick:()=>f.PopUp.set({title:i("APPS.NOTES.DELETE_TITLE").format({title:o.title}),description:i("APPS.NOTES.DELETE_TEXT").format({title:o.title}),buttons:[{title:i("APPS.NOTES.BUTTON_CANCEL")},{title:i("APPS.NOTES.BUTTON_DELETE"),color:"red",cb:()=>C(o.id)}]})}),n("div",{className:"amount",children:i("APPS.NOTES.LAST_EDITED").format({date:v(o.timestamp)})}),n(F,{onClick:()=>f.Share.set({type:"note",data:o})})]})]}):c(T.div,{...P("left","notes",.2),className:"notes-wrapper ",children:[n("div",{className:"title",children:i("APPS.NOTES.TITLE")}),n(L,{placeholder:i("APPS.NOTES.SEARCH_PLACEHOLDER"),onChange:e=>O(e.target.value)}),n("div",{className:"notes-body",children:n("div",{className:"notes-list",children:a==null?void 0:a.filter(e=>{var s,t;return((s=e.title)==null?void 0:s.toLowerCase().includes(N==null?void 0:N.toLowerCase()))||((t=e.content)==null?void 0:t.toLowerCase().includes(N==null?void 0:N.toLowerCase()))}).sort((e,s)=>s.timestamp-e.timestamp).map((e,s)=>c("div",{className:"note-item",onClick:()=>d(e),children:[n("div",{className:"note-title",children:e.title}),c("div",{className:"note-details",children:[n("div",{className:"date",children:v(e.timestamp)}),n("div",{className:"content",children:e.content.length>30?e.content.slice(0,30)+"...":e.content})]})]},s))})}),c("div",{className:"notes-bottom",children:[n(w,{className:"hidden"}),n("div",{className:"amount",children:i("APPS.NOTES.FOOTER").format({amount:(a==null?void 0:a.length)??0})}),n(D,{onClick:A})]})]})})}export{M as default};
